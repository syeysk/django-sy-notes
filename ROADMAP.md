# Дорожная карта

## Разработка

### Ключевые пункты - функционал

- [ ] Сделать интерфейс для импорта/экспорта заметок: архив с файлами, Github
  - при экспорте хранилища в архив помещать и файл-настройки в формате Obsidian, содержащий название хранилища
- [ ] Сделать интерфейс для настройки хука автообновления базы при добавлении новой заметки на Github
- [ ] Добавить механизм для импорта заметки внешними сервисами (холст фасилитации, дорожная карта, сканер книг и т. д.)
- [ ] Написать расширение для Obsidian - для локального использования заметок и их импорт в микросервис
- [ ] Написать адаптер внешней базы для Яндекс.Диска
- [ ] Написать адаптер внешней базы для хранения заметок в файловой системе
- [ ] На странице заметки - кнопка для скачивания заметки в PDF или Markdown
- [ ] Добавить поддержку мультиязычности, выполнить перевод на английский язык
- [ ] Вести историю изменений заметок: историю делать модулем [difflib](https://docs.python.org/3/library/difflib.html).
  Добавить отдельную модель с полями: модель, поле, дельта, пользователь, было ли изменения приняты модераторами
- [ ] Добавить окошко для редактирования yaml-содержимого (мета-информации) заметки
- [ ] Сделать отображение мета-информации о заметке на странице заметки
- [ ] Сделать поддержку LaTeX в заметках (например `$\ce{C=C}$`)
  - Примеры для химии (расширение mhchem): https://mhchem.github.io/MathJax-mhchem/
  - Описание расширения mchchem: https://docs.mathjax.org/en/latest/input/tex/extensions/mhchem.html
  - Расширения, поддерживаемы Obsidian: https://docs.mathjax.org/en/latest/input/tex/extensions/index.html
  - ОписаниеJavascript-библиотеки MathJax для интерпретации LaTeX: https://docs.mathjax.org/en/latest/basic/mathjax.html
  - Описание формата Markdown в Obsidian, который должен поддерживать микросервис: https://publish.obsidian.md/help-ru/%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%B0/%D0%A4%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%B7%D0%B0%D0%BC%D0%B5%D1%82%D0%BE%D0%BA
- [ ] ссылка на заметку в другом хранилище должна выглядеть так: `[Ссылка на файл](obsidian://open?vault=MainVault&file=MyNote.md)`
  (в редакторе по нажатию кнопки "Добавить ссылку на заметку")
- [ ] возможность делать форки хранилищ
- [ ] указание seo-описания и ключевых слов в yaml-шапке заметки (отобразятся в тегах head->meta)
- [ ] При сохранении заметки проверять, удалили ли ссылку на картинку. Если да, то картинку удалять их с диска.
- [ ] На странице заметки - список заметок сбоку, поиск по заметкам (по аналогии с Obsidian)

### Ключевые пункты - техническое

- [ ] Внедрить Poetry
- [ ] Настроить Docker-контейнер
- [ ] Тесты для API
- [ ] Тесты для веб-интерфейса

### Технический долг

- [ ] Поиск заметок по хештегу
- [ ] В подсветке синтаксиса Markdown сделать динамическую подгрузку подсветки встроенного исходного языков
  https://codemirror.net/5/doc/manual.html#fromTextArea:~:text=of%20this%20method.-,Module%20loaders,-The%20files%20in
- [ ] Добавить в редактор кнопки для вставки текста: курсив, ссылка, подчёркнутый, зачёркнутый, жирный, изменение регистра
- [ ] При добавлении заметки: кнопка "Отменить" должна возвращать на предыдущую страницу
- [ ] При добавлении заметки: Заголовок "Новая заметка" вместо пустого заголовка
- [ ] При копировании заметок из одной базы в другую нужно не очищать заметки, а проверять наличие дублей по заголовку. Пользователю сообщать о дублях с предложением перезаписать/отклонить заметку
- [ ] При копировании заметок из одной базы в другую: добавить галку очистки базы
- [ ] При очищении базы вывести предупреждение о необратимости действия и запросить подтверждение у пользователя
- [ ] При импорте/экспорте уведомлять пользователя об успешном завершении действия
- [ ] На странице списка заметок обрезать заметки средствами базы, а не в шаблоне
- [ ] При указании ссылки на несуществующую заметку такая заметка должна создаться автоматически.
- [ ] Если заметка не существует, то на странице об этом уведомляется и предлагается ссылка, по которой открывается форма создания заметки (с ведённым заголовком)
- [ ] Сделать добавление картинок заметкам для других адаптеров (не только DjangoAdapter)
- [ ] Перед загрузкой картинки проверять хеш: вычисленный и пришедший с браузера. Игнорить файл, если не совпадают.
- [ ] Если картинки нет в заметке, то не загружать картинку.
- [ ] При экспорте заметки экспортировать также и картинки.
- [ ] Для API: выдавать 404, если база знаний была не найдена.
- [ ] Сделать команду для инспекции картинок: проверять, что картинки из файловой системы действительно есть в заметках.

## Безопасность

- [ ] Заблокировать поля для заметок и хранилищ, у которых имя начинается с "."

## Маркетинг

- [ ] Разработать заглавную промо-страницу

## Новый функционал

- [ ] Разместить ссылку на сканер заметок и книг
- [ ] Сделать публикацию заметки из сервиса в другие сервисы
